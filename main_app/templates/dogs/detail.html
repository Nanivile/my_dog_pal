{% extends 'base.html' %}
{% block content %}

<h1>{{ dog.name }}'s Portal</h1>


<div class="card">
    <div class="card-content">
        <div class="profile-header">
            <h3>{{ dog.name }}</h3>
            {% if dog.img_url %}
            <img src="{{ dog.img_url }}" alt="{{ dog.name }}" class="profile-image">
            {% else %}
            <img src="https://i.imgur.com/DMskkHv.png" alt="No Photo" class="profile-image">
            {% endif %}
        </div>
        <div class="profile-details">
            <p><strong>Breed:</strong> {{ dog.breed }}</p>
            <p><strong>Neutered/Spayed:</strong> {% if dog.neutered_spayed %}Yes{% else %}No{% endif %}</p>
            <p><strong>Weight:</strong> {{ dog.weight }}</p>
            <p><strong>Birthdate:</strong> {{ dog.birthdate }}</p>
            <p><strong>Calculator Weights:</strong></p>
            {% for calculate in dog.dogcalculator_set.all %}
            <ul class="calculator-weights">
                <li>Ideal weight: <span id="weight">{{ calculate.weight }}</span></li>
                <li>Activity level: <span id="activity">{{ calculate.activity }}</span></li>
                <li>Servings Per Cup: <span id="servingspercup">{{ calculate.servingspercup }}</span></li>
                <li>Food Per Day: {{calculate.kcal_per_day}}</li>
            </ul>
            {% endfor %}
        </div>
    </div>
    <div class="card-actions">
        <a href="{% url 'dogs_delete' dog.id %}" class="btn-delete">Delete</a>
        <a href="{% url 'dogs_update' dog.id %}" class="btn-edit">Edit</a>
    </div>
</div>

<div class="form-box">
    <div class="card">
        <h3>Photos</h3>
        <div class="card-content">
            {% for photo in dog.photo_set.all %}
            <img class="responsive-img card-panel" src="{{photo.url}}" alt="Dog Photo">
            {% empty %}
            <div class="card-panel teal-text center-align">No Photos Uploaded</div>
            {% endfor %}
        </div>
        <form action="{% url 'add_photo' dog.id %}" enctype="multipart/form-data" method="POST" class="card-panel">
            {% csrf_token %}
            <input type="file" name="photo-file">
            <br><br>
            <button type="submit" class="btn">Upload Photo</button>
        </form>
    </div>
</div>

<hr>
    <h3>Food</h3>
    {% if dog.dogfood.count %}
        {% for food in dog.dogfood.all %}
            <p><strong>{{ food.name }}</strong></p>
            <p><strong>Caloric Content</strong></p>
            <p>{{ food.gramperserving }} kcal/kg, {{ food.kcalperserving }} kcal/cup</p>
            <p><strong>{{ food.current_food }}</strong></p>
            <p><strong>{{ food.new_food }}</strong></p>
            <form action="{% url 'unassoc_dogfood' dog.id food.id %}">
                {% csrf_token %}
                <button type="submit" class="btn">Remove</button>
            </form>
        {% endfor %}
    {% else %}
        <h5>No Dogfood</h5>
    {% endif %}
<hr>

<div class="col s6">
    <h3>Dog Food Options</h3>
    {% if dogfood.count %}
        {% for food in dogfood %}
            <div class="card">
                <div class="card-content">
                <span class="card-title">
                    <p><strong>{{ food.name }}</strong></p>
                    <p><strong>{{ food.kcalperserving }}</strong></p>
                    <p><strong>{{ food.gramperserving }}</strong></p>
                    <p><strong>{{ food.current_food }}</strong></p>
                    <p><strong>{{ food.new_food }}</strong></p>
                </span>
                <div class="card-content">
                    <form action="{% url 'assoc_dogfood' dog.id food.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn">Add</button>
                    </form>
                </div>
            </div>
        </div>    
    {% endfor %}
    {% else %}
        <p>No available dogfood found</p>
    {% endif %}
</div>

<div class="card">
    <h3>Dog Food Calculator</h3>
    <div class="card-content">
        <form action="{% url 'dogcalculator_create' dog.id %}" method="POST">
            {% csrf_token %}
            {{ dogcalculator_form.as_p }}
            <input type="submit" value="Calculate" class="btn">
        </form>
    </div>
</div>


{% endblock %}